

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>fteikpy’s documentation &mdash; fteikpy 2.1.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API Reference" href="api/index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="#" class="icon icon-home"> fteikpy
          

          
          </a>

          
            
            
              <div class="version">
                2.1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Reference documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/index.html">API Reference</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">fteikpy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="#" class="icon icon-home"></a> &raquo;</li>
        
      <li>fteikpy’s documentation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="fteikpy-s-documentation">
<h1>fteikpy’s documentation<a class="headerlink" href="#fteikpy-s-documentation" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="fteikpy">
<h1>fteikpy<a class="headerlink" href="#fteikpy" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="https://github.com/keurfonluu/fteikpy/blob/master/LICENSE"><img alt="License" src="https://img.shields.io/github/license/keurfonluu/fteikpy" /></a> <a class="reference external" href="https://github.com/keurfonluu/fteikpy"><img alt="Stars" src="https://img.shields.io/github/stars/keurfonluu/fteikpy?logo=github" /></a> <a class="reference external" href="https://pypi.org/pypi/fteikpy/"><img alt="Pyversions" src="https://img.shields.io/pypi/pyversions/fteikpy.svg?style=flat" /></a> <a class="reference external" href="https://pypi.org/project/fteikpy"><img alt="Version" src="https://img.shields.io/pypi/v/fteikpy.svg?style=flat" /></a> <a class="reference external" href="https://pepy.tech/project/fteikpy"><img alt="Downloads" src="https://pepy.tech/badge/fteikpy" /></a> <a class="reference external" href="https://github.com/psf/black"><img alt="Code style: black" src="https://img.shields.io/badge/code%20style-black-000000.svg?style=flat" /></a> <a class="reference external" href="https://www.codacy.com/gh/keurfonluu/fteikpy/dashboard?utm_source=github.com&amp;amp;utm_medium=referral&amp;amp;utm_content=keurfonluu/fteikpy&amp;amp;utm_campaign=Badge_Grade"><img alt="Codacy Badge" src="https://img.shields.io/codacy/grade/29b21d65d07e40219dcc9ad1c978cbeb.svg?style=flat" /></a> <a class="reference external" href="https://codecov.io/gh/keurfonluu/fteikpy"><img alt="Codecov" src="https://img.shields.io/codecov/c/github/keurfonluu/fteikpy.svg?style=flat" /></a> <a class="reference external" href="https://github.com/keurfonluu/fteikpy"><img alt="Build" src="https://img.shields.io/github/workflow/status/keurfonluu/fteikpy/Python%20package" /></a> <a class="reference external" href="https://keurfonluu.github.io/fteikpy/"><img alt="Travis" src="https://img.shields.io/travis/com/keurfonluu/fteikpy/master?label=docs" /></a></p>
<p><strong>fteikpy</strong> is a Python library that computes accurate first arrival traveltimes in 2D and 3D heterogenous isotropic velocity models. The algorithm handles properly the curvature of wavefronts close to the source which can be placed without any problem between grid points.</p>
<p>The code is based on <a class="reference external" href="https://github.com/Mark-Noble/FTeik-Eikonal-Solver">FTeik</a> implemented in Python and compiled <a class="reference external" href="https://en.wikipedia.org/wiki/Just-in-time_compilation">just-in-time</a> with <a class="reference external" href="https://numba.pydata.org/">numba</a>.</p>
<div class="figure align-center" id="id1">
<a class="reference internal image-reference" href="https://raw.githubusercontent.com/keurfonluu/fteikpy/master/.github/sample.gif"><img alt="sample-marmousi" src="https://raw.githubusercontent.com/keurfonluu/fteikpy/master/.github/sample.gif" style="width: 100%;" /></a>
<p class="caption"><span class="caption-text">Computation of traveltimes and ray-tracing on smoothed Marmousi velocity model.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
<div class="section" id="features">
<h2>Features<a class="headerlink" href="#features" title="Permalink to this headline">¶</a></h2>
<p>Forward modeling:</p>
<ul class="simple">
<li><p>Compute traveltimes in 2D and 3D Cartesian grids with the possibility to use a different grid spacing in Z, X and Y directions,</p></li>
<li><p>Compute traveltime gradients at runtime or a posteriori,</p></li>
<li><p>A posteriori 2D and 3D ray-tracing.</p></li>
</ul>
<p>Parallel:</p>
<ul class="simple">
<li><p>Traveltime grids are seemlessly computed in parallel for different sources,</p></li>
<li><p>Raypaths from a given source to different locations are also evaluated in parallel.</p></li>
</ul>
</div>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>The recommended way to install <strong>fteikpy</strong> and all its dependencies is through the Python Package Index:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install fteikpy --user
</pre></div>
</div>
<p>Otherwise, clone and extract the package, then run from the package location:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install . --user
</pre></div>
</div>
<p>To test the integrity of the installed package, check out this repository and run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pytest
</pre></div>
</div>
</div>
<div class="section" id="documentation">
<h2>Documentation<a class="headerlink" href="#documentation" title="Permalink to this headline">¶</a></h2>
<p>Refer to the online <a class="reference external" href="https://keurfonluu.github.io/fteikpy/">documentation</a> for detailed description of the API and examples.</p>
<p>Alternatively, the documentation can be built using <a class="reference external" href="https://www.sphinx-doc.org/en/master/">Sphinx</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install -r doc/requirements.txt
sphinx-build -b html doc/source doc/build
</pre></div>
</div>
</div>
<div class="section" id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p>The following example computes the traveltime grid in a 3D homogenous velocity model:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">fteikpy</span> <span class="kn">import</span> <span class="n">Eikonal3D</span>

<span class="c1"># Velocity model</span>
<span class="n">velocity_model</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">dz</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span>

<span class="c1"># Solve Eikonal at source</span>
<span class="n">eik</span> <span class="o">=</span> <span class="n">Eikonal3D</span><span class="p">(</span><span class="n">velocity_model</span><span class="p">,</span> <span class="n">gridsize</span><span class="o">=</span><span class="p">(</span><span class="n">dz</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">))</span>
<span class="n">tt</span> <span class="o">=</span> <span class="n">eik</span><span class="o">.</span><span class="n">solve</span><span class="p">((</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">))</span>

<span class="c1"># Get traveltime at specific grid point</span>
<span class="n">t1</span> <span class="o">=</span> <span class="n">tt</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>

<span class="c1"># Or get traveltime at any point in the grid</span>
<span class="n">t2</span> <span class="o">=</span> <span class="n">tt</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="mf">7.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="contributing">
<h2>Contributing<a class="headerlink" href="#contributing" title="Permalink to this headline">¶</a></h2>
<p>Please refer to the <a class="reference external" href="https://github.com/keurfonluu/fteikpy/blob/master/CONTRIBUTING.rst">Contributing
Guidelines</a> to see how you can help. This project is released with a <a class="reference external" href="https://github.com/keurfonluu/fteikpy/blob/master/CODE_OF_CONDUCT.rst">Code of Conduct</a> which you agree to abide by when contributing.</p>
</div>
<div class="section" id="citing-fteikpy">
<h2>Citing fteikpy<a class="headerlink" href="#citing-fteikpy" title="Permalink to this headline">¶</a></h2>
<p>If you are using <strong>fteikpy</strong> in your scientific research, please consider mentioning it (e.g. in Acknowledgements) and citing the following paper:</p>
<blockquote>
<div><p>Noble, M., Gesret, A., and Belayouni, N., (2014). Accurate 3-D finite difference computation of traveltimes in strongly heterogeneous media. Geophysical Journal International, 199(3): 1572-1585, <a class="reference external" href="https://doi.org/10.1093/gji/ggu358">https://doi.org/10.1093/gji/ggu358</a></p>
</div></blockquote>
<p>BibTex:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@article</span><span class="p">{</span><span class="n">Noble2014</span><span class="p">,</span>
   <span class="n">doi</span> <span class="o">=</span> <span class="p">{</span><span class="mf">10.1093</span><span class="o">/</span><span class="n">gji</span><span class="o">/</span><span class="n">ggu358</span><span class="p">},</span>
   <span class="n">url</span> <span class="o">=</span> <span class="p">{</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">doi</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="mf">10.1093</span><span class="o">/</span><span class="n">gji</span><span class="o">/</span><span class="n">ggu358</span><span class="p">},</span>
   <span class="n">year</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2014</span><span class="p">},</span>
   <span class="n">issn</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1365246</span><span class="n">X</span><span class="p">},</span>
   <span class="n">volume</span> <span class="o">=</span> <span class="p">{</span><span class="mi">199</span><span class="p">},</span>
   <span class="n">number</span> <span class="o">=</span> <span class="p">{</span><span class="mi">3</span><span class="p">},</span>
   <span class="n">pages</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1572</span><span class="o">--</span><span class="mi">1585</span><span class="p">},</span>
   <span class="n">author</span> <span class="o">=</span> <span class="p">{</span><span class="n">Noble</span><span class="p">,</span> <span class="n">Mark</span> <span class="ow">and</span> <span class="n">Gesret</span><span class="p">,</span> <span class="n">Alexandrine</span> <span class="ow">and</span> <span class="n">Belayouni</span><span class="p">,</span> <span class="n">Nidhal</span><span class="p">},</span>
   <span class="n">title</span> <span class="o">=</span> <span class="p">{</span><span class="n">Accurate</span> <span class="mi">3</span><span class="o">-</span><span class="p">{</span><span class="n">D</span><span class="p">}</span> <span class="n">finite</span> <span class="n">difference</span> <span class="n">computation</span> <span class="n">of</span> <span class="n">traveltimes</span> <span class="ow">in</span> <span class="n">strongly</span> <span class="n">heterogeneous</span> <span class="n">media</span><span class="p">},</span>
   <span class="n">journal</span> <span class="o">=</span> <span class="p">{</span><span class="n">Geophysical</span> <span class="n">Journal</span> <span class="n">International</span><span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="toctree-wrapper compound">
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="api/index.html" class="btn btn-neutral float-right" title="API Reference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, Keurfon Luu.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>